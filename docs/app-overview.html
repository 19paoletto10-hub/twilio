<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8" />
    <title>Twilio Chat App v3.2.8 â€“ Dokumentacja rozwiÄ…zania</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Enterprise SMS Communication Hub - profesjonalna platforma do zarzÄ…dzania komunikacjÄ… SMS z AI, RAG i automatyzacjÄ…" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --text-dim: #64748b;
            --border: #334155;
            
            --gradient-primary: linear-gradient(135deg, #6366f1, #8b5cf6);
            --gradient-success: linear-gradient(135deg, #10b981, #059669);
            --gradient-info: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.7;
            font-size: 16px;
        }
        
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            padding: 0 2rem;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 64px;
        }
        
        .nav-logo {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .nav-logo-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .nav-links { display: flex; gap: 1.5rem; list-style: none; }
        .nav-links a { color: var(--text-muted); text-decoration: none; font-size: 0.9rem; font-weight: 500; transition: color 0.2s; }
        .nav-links a:hover { color: var(--text); }
        .nav-version { background: var(--gradient-primary); color: white; padding: 0.35rem 0.75rem; border-radius: 6px; font-weight: 600; font-size: 0.8rem; }
        
        .hero {
            padding: 8rem 2rem 4rem;
            text-align: center;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
            position: relative;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at 50% 0%, rgba(99, 102, 241, 0.15) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .hero-content { position: relative; z-index: 1; max-width: 800px; margin: 0 auto; }
        .hero-badges { display: flex; justify-content: center; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1.5rem; }
        .badge { display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.35rem 0.8rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 50px; font-size: 0.8rem; font-weight: 500; }
        .badge-primary { border-color: var(--primary); color: var(--primary-light); }
        .badge-success { border-color: var(--success); color: var(--success); }
        .badge-info { border-color: var(--info); color: var(--info); }
        .badge-warning { border-color: var(--warning); color: var(--warning); }
        
        .hero h1 { font-size: clamp(2rem, 5vw, 3rem); font-weight: 800; margin-bottom: 1rem; background: linear-gradient(135deg, #fff 0%, #94a3b8 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .hero-subtitle { font-size: 1.1rem; color: var(--text-muted); max-width: 600px; margin: 0 auto; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        section { padding: 4rem 0; }
        .section-header { text-align: center; margin-bottom: 3rem; }
        .section-header h2 { font-size: 2rem; font-weight: 700; margin-bottom: 0.75rem; }
        .section-header p { color: var(--text-muted); font-size: 1rem; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 1.75rem; transition: transform 0.3s, border-color 0.3s, box-shadow 0.3s; }
        .card:hover { transform: translateY(-4px); border-color: var(--primary); box-shadow: 0 8px 30px rgba(99, 102, 241, 0.15); }
        .card-icon { width: 48px; height: 48px; background: var(--gradient-primary); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin-bottom: 1rem; }
        .card-icon.success { background: var(--gradient-success); }
        .card-icon.info { background: var(--gradient-info); }
        .card h3 { font-size: 1.2rem; font-weight: 600; margin-bottom: 0.75rem; }
        .card p { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 1rem; }
        .card ul { list-style: none; padding: 0; }
        .card ul li { position: relative; padding-left: 1.5rem; margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--text-muted); }
        .card ul li::before { content: 'âœ“'; position: absolute; left: 0; color: var(--success); font-weight: 600; }
        
        .new-feature { position: relative; }
        .new-feature::after { content: 'NEW'; position: absolute; top: 1rem; right: 1rem; background: var(--gradient-success); color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.7rem; font-weight: 700; }
        
        .architecture { background: linear-gradient(180deg, var(--bg-dark) 0%, var(--bg-card) 50%, var(--bg-dark) 100%); }
        .arch-diagram { background: #0d1117; border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; overflow-x: auto; }
        .arch-diagram pre { font-family: 'Fira Code', 'Monaco', monospace; font-size: 0.7rem; line-height: 1.4; color: #e6edf3; margin: 0; }
        
        code { background: rgba(99, 102, 241, 0.15); color: var(--primary-light); padding: 0.15rem 0.4rem; border-radius: 4px; font-family: 'Fira Code', monospace; font-size: 0.85em; }
        pre { background: #0d1117; border: 1px solid var(--border); border-radius: 12px; padding: 1.25rem; overflow-x: auto; font-size: 0.85rem; line-height: 1.6; }
        pre code { background: none; padding: 0; color: #e6edf3; }
        
        .table-container { overflow-x: auto; border-radius: 12px; border: 1px solid var(--border); }
        table { width: 100%; border-collapse: collapse; background: var(--bg-card); }
        th { background: rgba(99, 102, 241, 0.1); padding: 1rem; text-align: left; font-weight: 600; color: var(--primary-light); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; }
        td { padding: 1rem; border-top: 1px solid var(--border); font-size: 0.9rem; }
        tr:hover td { background: rgba(99, 102, 241, 0.05); }
        
        .module-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; }
        .module-item { background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; padding: 1.25rem; transition: border-color 0.2s; }
        .module-item:hover { border-color: var(--primary); }
        .module-item h4 { font-size: 0.95rem; font-weight: 600; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
        .module-item h4 code { font-size: 0.8rem; }
        .module-item p { color: var(--text-muted); font-size: 0.85rem; margin: 0; }
        
        .changelog { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 2rem; margin-top: 2rem; }
        .changelog h3 { font-size: 1.3rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; }
        .changelog-item { border-left: 3px solid var(--primary); padding-left: 1rem; margin-bottom: 1.5rem; }
        .changelog-item h4 { font-size: 1rem; margin-bottom: 0.5rem; color: var(--primary-light); }
        .changelog-item p { font-size: 0.9rem; color: var(--text-muted); }
        
        footer { background: var(--bg-card); border-top: 1px solid var(--border); padding: 3rem 2rem; text-align: center; }
        .footer-links { display: flex; justify-content: center; gap: 2rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .footer-links a { color: var(--text-muted); text-decoration: none; font-size: 0.9rem; transition: color 0.2s; }
        .footer-links a:hover { color: var(--primary-light); }
        .footer-copy { color: var(--text-dim); font-size: 0.85rem; }
        
        @media (max-width: 768px) {
            nav { padding: 0 1rem; }
            .nav-links { display: none; }
            .hero { padding: 6rem 1.5rem 3rem; }
            section { padding: 3rem 0; }
            .container { padding: 0 1.5rem; }
            .grid { grid-template-columns: 1fr; }
        }
        
        @media print {
            nav, footer { display: none; }
            .hero { padding-top: 2rem; }
            .card:hover { transform: none; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="#" class="nav-logo"><span class="nav-logo-icon">ğŸ“±</span>Twilio Chat App</a>
            <ul class="nav-links">
                <li><a href="#features">Funkcje</a></li>
                <li><a href="#whats-new">NowoÅ›ci</a></li>
                <li><a href="#architecture">Architektura</a></li>
                <li><a href="#modules">ModuÅ‚y</a></li>
                <li><a href="#database">Baza danych</a></li>
                <li><a href="#deployment">Deployment</a></li>
            </ul>
            <span class="nav-version">v3.2.8</span>
        </div>
    </nav>

    <section class="hero">
        <div class="hero-content">
            <div class="hero-badges">
                <span class="badge badge-primary">ğŸ“¦ v3.2.8</span>
                <span class="badge badge-success">âœ… 0 Pylance Errors</span>
                <span class="badge badge-info">ğŸ³ Docker Ready</span>
                <span class="badge badge-warning">ğŸ†• News Fallback</span>
            </div>
            <h1>Dokumentacja rozwiÄ…zania</h1>
            <p class="hero-subtitle">Enterprise-Grade SMS Communication Hub<br>Python 3.12+ â€¢ Flask 3.x â€¢ Twilio â€¢ OpenAI â€¢ FAISS â€¢ Docker</p>
        </div>
    </section>

    <section id="whats-new">
        <div class="container">
            <div class="section-header">
                <h2>ğŸ†• Co nowego w v3.2.8</h2>
                <p>Najnowsze ulepszenia i nowe funkcje</p>
            </div>
            <div class="grid">
                <div class="card new-feature">
                    <div class="card-icon warning">ğŸ“°</div>
                    <h3>/news Fallback (v3.2.8)</h3>
                    <p>Graceful degradation dla wyÅ‚Ä…czonego listenera</p>
                    <ul>
                        <li>Automatyczna informacja gdy /news niedostÄ™pne</li>
                        <li>Status tracking: news-disabled</li>
                        <li>PeÅ‚ne logowanie diagnostyczne</li>
                        <li>Lepsze UX dla uÅ¼ytkownikÃ³w</li>
                    </ul>
                </div>
                <div class="card new-feature">
                    <div class="card-icon success">ğŸ“±</div>
                    <h3>Chunked SMS (v3.2.6)</h3>
                    <p>Automatyczne dzielenie dÅ‚ugich wiadomoÅ›ci SMS</p>
                    <ul>
                        <li>WiadomoÅ›ci >1500 znakÃ³w dzielone na czÄ™Å›ci</li>
                        <li>Bufor bezpieczeÅ„stwa (100 zn. przed limitem)</li>
                        <li>Wielokrotne SID-y dla Å›ledzenia dostawy</li>
                        <li>PeÅ‚na kompatybilnoÅ›Ä‡ wsteczna</li>
                    </ul>
                </div>
                <div class="card new-feature">
                    <div class="card-icon">ğŸ’¬</div>
                    <h3>Dynamic Chat Headers (v3.2.7)</h3>
                    <p>Dynamiczna aktualizacja nagÅ‚Ã³wkÃ³w konwersacji</p>
                    <ul>
                        <li>NagÅ‚Ã³wek wÄ…tku aktualizuje siÄ™ przy przeÅ‚Ä…czaniu</li>
                        <li>Data ostatniej aktywnoÅ›ci w czasie rzeczywistym</li>
                        <li>Synchronizacja wszystkich elementÃ³w UI</li>
                        <li>Lepsze UX przy wielokrotnych rozmowach</li>
                    </ul>
                </div>
            </div>
            
            <div class="changelog">
                <h3>ğŸ“‹ Historia zmian</h3>
                <div class="changelog-item">
                    <h4>v3.2.8 - News Command Fallback</h4>
                    <p>Graceful fallback dla komendy /news gdy listener jest wyÅ‚Ä…czony. UÅ¼ytkownicy otrzymujÄ… jasnÄ… informacjÄ™ o niedostÄ™pnoÅ›ci funkcji.</p>
                </div>
                <div class="changelog-item">
                    <h4>v3.2.7 - Dynamic Chat Headers</h4>
                    <p>Dynamiczna aktualizacja nagÅ‚Ã³wkÃ³w wÄ…tku i daty ostatniej aktywnoÅ›ci przy przeÅ‚Ä…czaniu konwersacji. Synchronizacja wszystkich elementÃ³w UI.</p>
                </div>
                <div class="changelog-item">
                    <h4>v3.2.6 - Chunked SMS & Professional RAG</h4>
                    <p>Automatyczne dzielenie dÅ‚ugich SMS-Ã³w. Profesjonalne streszczenia newsÃ³w z gwarancjÄ… pokrycia wszystkich 8 kategorii.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="features">
        <div class="container">
            <div class="section-header">
                <h2>âœ¨ NajwaÅ¼niejsze funkcje</h2>
                <p>Kompletne rozwiÄ…zanie do zarzÄ…dzania komunikacjÄ… SMS</p>
            </div>
            <div class="grid">
                <div class="card">
                    <div class="card-icon">ğŸ¤–</div>
                    <h3>Auto-reply & AI Auto-reply</h3>
                    <p>Automatyczne odpowiedzi sterowane z panelu lub przez zmienne Å›rodowiskowe</p>
                    <ul><li>Klasyczny auto-reply â€“ szablon tekstowy</li><li>AI auto-reply â€“ OpenAI Chat Completions</li><li>Tryby wzajemnie wykluczajÄ…ce</li><li>Bez retro-odpowiedzi</li></ul>
                </div>
                <div class="card">
                    <div class="card-icon">ğŸ–¥ï¸</div>
                    <h3>Panel WWW</h3>
                    <p>Nowoczesny dashboard dla operatora, Bootstrap 5</p>
                    <ul><li>WiadomoÅ›ci â€“ statystyki, wysyÅ‚ka, filtry</li><li>Auto-odpowiedÅº â€“ konfiguracja szablonu</li><li>AI â€“ konfiguracja OpenAI, testy</li><li>News/FAISS â€“ RAG i semantic search</li><li>Listeners â€“ interaktywne komendy SMS</li></ul>
                </div>
                <div class="card">
                    <div class="card-icon">ğŸ”Œ</div>
                    <h3>REST API & Webhooki</h3>
                    <p>Kompletna warstwa HTTP dla integracji zewnÄ™trznych</p>
                    <ul><li>Webhooki Twilio z walidacjÄ… podpisu</li><li>API wiadomoÅ›ci â€“ CRUD, sync</li><li>API konfiguracji â€“ AI, auto-reply</li><li>Smart chunking â€“ podziaÅ‚ dÅ‚ugich SMS</li></ul>
                </div>
                <div class="card">
                    <div class="card-icon">âš™ï¸</div>
                    <h3>Background Workery</h3>
                    <p>Przetwarzanie w tle z kolejkami w pamiÄ™ci</p>
                    <ul><li>Worker auto_reply â€“ AI lub klasyczny</li><li>Worker reminder â€“ cykliczne SMS</li><li>Worker multi_sms â€“ kampanie batch</li><li>News scheduler â€“ dzienne podsumowania</li></ul>
                </div>
                <div class="card">
                    <div class="card-icon">ğŸ“°</div>
                    <h3>RAG / FAISS</h3>
                    <p>Semantic search i baza wiedzy</p>
                    <ul><li>Indeks wektorowy FAISS</li><li>Listener /news [pytanie]</li><li>Scraper Business Insider</li><li>8 kategorii newsÃ³w</li></ul>
                </div>
                <div class="card">
                    <div class="card-icon">ğŸ”’</div>
                    <h3>Enterprise Quality</h3>
                    <p>Kod na poziomie produkcyjnym</p>
                    <ul><li>0 bÅ‚Ä™dÃ³w Pylance w strict mode</li><li>Professional docstrings</li><li>Defensive programming</li><li>Database deduplication</li></ul>
                </div>
            </div>
        </div>
    </section>

    <section id="architecture" class="architecture">
        <div class="container">
            <div class="section-header">
                <h2>ğŸ›ï¸ Architektura systemu</h2>
                <p>ModuÅ‚owa konstrukcja z workerami w tle</p>
            </div>
            <div class="arch-diagram">
                <pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TWILIO CLOUD                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Inbound SMS â”‚  â”‚ Status Hook â”‚  â”‚ Messaging Service       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                     â”‚
          â–¼                â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FLASK APPLICATION                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    webhooks.py                              â”‚â”‚
â”‚  â”‚  /twilio/inbound  â”‚  /twilio/status  â”‚  /api/*             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚           â”‚           â”‚           â”‚             â”‚           â”‚
â”‚  â–¼           â–¼           â–¼           â–¼             â–¼           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ AI  â”‚   â”‚Auto â”‚   â”‚Listenersâ”‚   â”‚News â”‚   â”‚ Multi    â”‚      â”‚
â”‚ â”‚Replyâ”‚   â”‚Replyâ”‚   â”‚ /news   â”‚   â”‚Schedâ”‚   â”‚ SMS      â”‚      â”‚
â”‚ â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    twilio_client.py                        â”‚â”‚
â”‚  â”‚  send_message()  â”‚  send_chunked_sms()  â”‚  send_reply()   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SQLite (data/)       â”‚      â”‚   FAISS (X1_data/)     â”‚
â”‚  â”œâ”€â”€ messages           â”‚      â”‚  â”œâ”€â”€ index.faiss       â”‚
â”‚  â”œâ”€â”€ ai_config          â”‚      â”‚  â”œâ”€â”€ documents.jsonl   â”‚
â”‚  â”œâ”€â”€ listeners          â”‚      â”‚  â””â”€â”€ articles.jsonl    â”‚
â”‚  â”œâ”€â”€ multi_sms          â”‚      â”‚                        â”‚
â”‚  â””â”€â”€ news_recipients    â”‚      â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
            </div>
        </div>
    </section>

    <section id="modules">
        <div class="container">
            <div class="section-header">
                <h2>ğŸ“¦ ModuÅ‚y aplikacji</h2>
                <p>Kluczowe komponenty i ich odpowiedzialnoÅ›ci</p>
            </div>
            <div class="module-list">
                <div class="module-item"><h4>ğŸ”§ <code>app/__init__.py</code></h4><p>Fabryka Flask create_app(): konfiguracja, inicjalizacja, workery</p></div>
                <div class="module-item"><h4>ğŸŒ <code>app/webhooks.py</code></h4><p>REST API, webhooki Twilio, endpointy News/FAISS, chunked SMS</p></div>
                <div class="module-item"><h4>ğŸ¨ <code>app/ui.py</code></h4><p>Blueprint UI: dashboard, chat, templates Jinja2</p></div>
                <div class="module-item"><h4>ğŸ“ <code>app/twilio_client.py</code></h4><p>TwilioService: wysyÅ‚ka SMS, chunking, Messaging Service</p></div>
                <div class="module-item"><h4>ğŸ¤– <code>app/ai_service.py</code></h4><p>AIResponder: kontekst rozmowy, OpenAI Chat Completions</p></div>
                <div class="module-item"><h4>ğŸ” <code>app/auto_reply.py</code></h4><p>Worker auto-reply: kolejka, AI vs klasyczny tryb</p></div>
                <div class="module-item"><h4>ğŸ—„ï¸ <code>app/database.py</code></h4><p>SQLite: schemat, migracje, helpery CRUD (SCHEMA_VERSION=9)</p></div>
                <div class="module-item"><h4>ğŸ” <code>app/faiss_service.py</code></h4><p>FAISS: indeks wektorowy, semantic search, RAG all-categories</p></div>
                <div class="module-item"><h4>ğŸ•·ï¸ <code>app/scraper_service.py</code></h4><p>Scraper: Business Insider, artykuÅ‚y, 8 kategorii</p></div>
                <div class="module-item"><h4>ğŸ“… <code>app/news_scheduler.py</code></h4><p>Scheduler newsÃ³w: dzienne SMS do odbiorcÃ³w</p></div>
                <div class="module-item"><h4>â° <code>app/reminder.py</code></h4><p>Worker przypomnieÅ„: cykliczne SMS z harmonogramu</p></div>
                <div class="module-item"><h4>ğŸ“¨ <code>app/multi_sms.py</code></h4><p>Worker batch SMS: kampanie do wielu odbiorcÃ³w</p></div>
                <div class="module-item"><h4>ğŸ’¬ <code>app/message_utils.py</code></h4><p>NarzÄ™dzia SMS: chunking, MAX_SMS_CHARS, formatowanie</p></div>
                <div class="module-item"><h4>ğŸ” <code>app/security.py</code></h4><p>Walidacja podpisÃ³w Twilio, bezpieczeÅ„stwo webhookÃ³w</p></div>
            </div>
        </div>
    </section>

    <section id="database">
        <div class="container">
            <div class="section-header">
                <h2>ğŸ—ƒï¸ Model danych</h2>
                <p>SQLite z wersjonowanym schematem (SCHEMA_VERSION = 9)</p>
            </div>
            <div class="table-container">
                <table>
                    <thead><tr><th>Tabela</th><th>Opis</th><th>Kluczowe kolumny</th></tr></thead>
                    <tbody>
                        <tr><td><code>messages</code></td><td>Historia SMS (inbound/outbound)</td><td>sid, direction, to_number, from_number, body, status</td></tr>
                        <tr><td><code>auto_reply_config</code></td><td>Konfiguracja klasycznego auto-reply</td><td>enabled, message, enabled_since</td></tr>
                        <tr><td><code>ai_config</code></td><td>Konfiguracja AI/OpenAI</td><td>enabled, api_key, system_prompt, model, temperature</td></tr>
                        <tr><td><code>scheduled_messages</code></td><td>Zaplanowane przypomnienia</td><td>to_number, body, interval_seconds, next_run_at</td></tr>
                        <tr><td><code>multi_sms_batches</code></td><td>Batch SMS kampanie</td><td>body, status, total_recipients, success_count</td></tr>
                        <tr><td><code>multi_sms_recipients</code></td><td>Odbiorcy batch SMS</td><td>batch_id, number_normalized, status, message_sid</td></tr>
                        <tr><td><code>listeners</code></td><td>Interaktywne komendy SMS</td><td>name, trigger, enabled, handler_type</td></tr>
                        <tr><td><code>news_recipients</code></td><td>Odbiorcy newsÃ³w RAG</td><td>number, prompt, send_hour, enabled</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="deployment">
        <div class="container">
            <div class="section-header">
                <h2>ğŸš€ Uruchomienie</h2>
                <p>Lokalne Å›rodowisko deweloperskie i Docker</p>
            </div>
            <div class="grid">
                <div class="card"><h3>ğŸ–¥ï¸ Lokalnie</h3><pre><code>python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
cp .env.example .env
python run.py</code></pre><p style="margin-top:1rem">Panel: <code>http://localhost:3000</code></p></div>
                <div class="card"><h3>ğŸ³ Docker</h3><pre><code>cp .env.example .env
mkdir -p data X1_data
docker compose up --build</code></pre><p style="margin-top:1rem">Panel: <code>http://localhost:3000</code></p></div>
            </div>
            <div style="margin-top:2rem">
                <h3 style="margin-bottom:1rem">âš™ï¸ Kluczowe zmienne Å›rodowiskowe</h3>
                <div class="table-container">
                    <table>
                        <thead><tr><th>Zmienna</th><th>Opis</th><th>Wymagana</th></tr></thead>
                        <tbody>
                            <tr><td><code>TWILIO_ACCOUNT_SID</code></td><td>Twilio Account SID</td><td>âœ… Tak</td></tr>
                            <tr><td><code>TWILIO_AUTH_TOKEN</code></td><td>Twilio Auth Token</td><td>âœ… Tak</td></tr>
                            <tr><td><code>TWILIO_DEFAULT_FROM</code></td><td>Numer nadawcy (E.164)</td><td>âœ… Tak*</td></tr>
                            <tr><td><code>OPENAI_API_KEY</code></td><td>Klucz OpenAI dla AI</td><td>âŒ Opcjonalna</td></tr>
                            <tr><td><code>SECOND_OPENAI</code></td><td>Klucz OpenAI dla RAG/FAISS</td><td>âŒ Opcjonalna</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-links">
            <a href="../README.html">README</a>
            <a href="developer-guide.md">Developer Guide</a>
            <a href="docker-guide.md">Docker Guide</a>
            <a href="architecture-notes.md">Architecture</a>
            <a href="app-brochure.html">Broszura</a>
            <a href="https://github.com/19paoletto10-hub/twilio">GitHub</a>
        </div>
        <p class="footer-copy">Twilio Chat App v3.2.8 â€¢ Â© 2025 â€¢ Dokumentacja techniczna</p>
    </footer>
</body>
</html>
